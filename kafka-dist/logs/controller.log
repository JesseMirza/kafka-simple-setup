[2020-03-30 14:07:31,335] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:07:31,430] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-30 14:11:01,602] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:11:01,604] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:11:01,605] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:11:01,607] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:11:01,611] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-03-30 14:11:01,617] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:11:01,619] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:11:01,625] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-03-30 14:11:27,104] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:11:27,144] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:11:27,244] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 9 and epoch zk version is now 9 (kafka.controller.KafkaController)
[2020-03-30 14:11:27,271] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-03-30 14:11:27,304] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-30 14:11:27,332] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-30 14:11:27,368] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-03-30 14:11:27,379] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-30 14:11:27,632] INFO [Controller id=2] Initialized broker epochs cache: Map(1 -> 476, 2 -> 477) (kafka.controller.KafkaController)
[2020-03-30 14:11:27,672] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2020-03-30 14:11:27,740] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:11:27,851] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:11:27,898] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:11:27,899] INFO [Controller id=2] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2020-03-30 14:11:27,901] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2020-03-30 14:11:27,902] INFO [Controller id=2] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-30 14:11:27,903] INFO [Controller id=2] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-30 14:11:27,906] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-30 14:11:27,909] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:11:27,930] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-30 14:11:27,931] INFO [Controller id=2] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-30 14:11:27,935] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-30 14:11:27,936] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-03-30 14:11:27,947] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-30 14:11:28,142] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:11:28,163] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:11:28,262] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:11:28,298] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:11:28,299] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:11:28,302] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:11:28,386] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:11:28,389] INFO [Controller id=2] Ready to serve as the new controller with epoch 9 (kafka.controller.KafkaController)
[2020-03-30 14:11:28,405] INFO [Controller id=2] Removing partitions Set() from the list of reassigned partitions in zookeeper (kafka.controller.KafkaController)
[2020-03-30 14:11:28,407] INFO [Controller id=2] No more partitions need to be reassigned. Deleting zk path /admin/reassign_partitions (kafka.controller.KafkaController)
[2020-03-30 14:11:28,429] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-30 14:11:28,437] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-30 14:11:28,442] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-30 14:11:28,444] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-30 14:11:28,445] INFO [Controller id=2] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2020-03-30 14:11:28,532] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-30 14:11:28,979] INFO [RequestSendThread controllerId=2] Controller 2 connected to kafka1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:11:29,257] INFO [RequestSendThread controllerId=2] Controller 2 connected to kafka2:9095 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:11:33,538] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-30 14:11:33,541] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-30 14:11:33,544] DEBUG [Controller id=2] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-03-30 14:16:33,403] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-30 14:16:33,406] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-30 14:16:33,407] DEBUG [Controller id=2] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-03-30 14:21:33,260] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-30 14:21:33,263] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-30 14:21:33,264] DEBUG [Controller id=2] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-03-30 14:26:33,116] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-30 14:26:33,117] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-30 14:26:33,118] DEBUG [Controller id=2] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-03-30 14:26:57,369] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:26:57,371] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:26:57,372] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:26:57,373] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:26:57,375] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(2, 1) (kafka.controller.KafkaController)
[2020-03-30 14:26:57,379] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:26:57,383] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:26:57,383] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:26:57,388] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:26:57,388] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:26:57,390] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:26:57,393] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-03-30 14:26:57,397] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:26:57,399] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:26:57,399] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:26:57,400] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:26:57,400] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:26:57,405] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:26:57,406] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-03-30 14:26:57,409] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:26:57,409] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:26:57,426] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-03-30 14:31:21,683] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:31:21,790] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:31:21,919] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 10 and epoch zk version is now 10 (kafka.controller.KafkaController)
[2020-03-30 14:31:21,924] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-03-30 14:31:21,982] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-30 14:31:22,062] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-30 14:31:22,107] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-03-30 14:31:22,111] DEBUG [Controller id=3] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-30 14:31:22,327] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:31:22,386] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 634, 2 -> 635, 3 -> 633, 4 -> 636) (kafka.controller.KafkaController)
[2020-03-30 14:31:22,423] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:31:22,451] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1, 2, 3, 4) (kafka.controller.KafkaController)
[2020-03-30 14:31:22,583] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:31:22,607] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-30 14:31:22,684] DEBUG [Controller id=4] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-30 14:31:24,627] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:31:25,294] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:31:25,563] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:31:25,795] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:31:25,796] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:31:25,795] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:31:25,798] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:31:25,799] INFO [Controller id=1] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2020-03-30 14:31:25,800] INFO [Controller id=1] Currently active brokers in the cluster: Set(1, 2, 3, 4) (kafka.controller.KafkaController)
[2020-03-30 14:31:25,802] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-30 14:31:25,803] INFO [Controller id=1] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-30 14:31:25,804] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-30 14:31:25,813] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-30 14:31:25,814] INFO [Controller id=1] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-30 14:31:25,815] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-30 14:31:25,817] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-03-30 14:31:25,818] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-30 14:31:25,853] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:31:25,905] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:31:26,026] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:31:26,043] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:31:26,101] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:31:26,123] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:31:26,158] INFO [RequestSendThread controllerId=1] Controller 1 connected to kafka3:9097 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:31:26,160] INFO [RequestSendThread controllerId=1] Controller 1 connected to kafka4:9099 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:31:26,188] INFO [RequestSendThread controllerId=1] Controller 1 connected to kafka2:9095 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:31:26,220] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:31:26,241] INFO [Controller id=1] Ready to serve as the new controller with epoch 10 (kafka.controller.KafkaController)
[2020-03-30 14:31:26,248] INFO [RequestSendThread controllerId=1] Controller 1 connected to kafka1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:31:26,354] INFO [Controller id=1] Removing partitions Set() from the list of reassigned partitions in zookeeper (kafka.controller.KafkaController)
[2020-03-30 14:31:26,370] INFO [Controller id=1] No more partitions need to be reassigned. Deleting zk path /admin/reassign_partitions (kafka.controller.KafkaController)
[2020-03-30 14:31:26,419] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-30 14:31:26,426] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-30 14:31:26,436] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-30 14:31:26,438] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-30 14:31:26,460] INFO [Controller id=1] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2020-03-30 14:31:26,533] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-30 14:31:31,539] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-30 14:31:31,540] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-30 14:31:31,543] DEBUG [Controller id=1] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-03-30 14:32:09,185] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,206] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,209] DEBUG [Controller id=1] Live brokers: 2,3,4 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,218] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-03-30 14:32:09,253] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,256] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,257] DEBUG [Controller id=1] Live brokers: 3,4 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,259] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-03-30 14:32:09,260] INFO [Controller id=1] Shutting down broker 4 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,261] DEBUG [Controller id=1] All shutting down brokers: 1,2,4 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,263] DEBUG [Controller id=1] Live brokers: 3 (kafka.controller.KafkaController)
[2020-03-30 14:32:09,264] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-03-30 14:32:10,539] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:10,541] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:10,541] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:10,543] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:32:10,546] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-03-30 14:32:10,549] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:10,551] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:10,554] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2020-03-30 14:32:10,587] INFO [Controller id=1] Newly added brokers: , deleted brokers: 4, bounced brokers: , all live brokers: 1,2,3 (kafka.controller.KafkaController)
[2020-03-30 14:32:10,603] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,603] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,603] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,609] INFO [Controller id=1] Broker failure callback for 4 (kafka.controller.KafkaController)
[2020-03-30 14:32:10,612] INFO [Controller id=1] Removed 4 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-03-30 14:32:10,635] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka2:9095 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka2:9095 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:10,638] DEBUG [Controller id=1] Unregister BrokerModifications handler for Vector(4) (kafka.controller.KafkaController)
[2020-03-30 14:32:10,643] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 634, 2 -> 635, 3 -> 633) (kafka.controller.KafkaController)
[2020-03-30 14:32:10,635] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:10,747] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka2:9095 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka2:9095 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:10,749] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:10,835] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:10,837] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:10,838] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:10,839] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:32:10,843] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-03-30 14:32:10,848] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:10,851] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:10,855] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-03-30 14:32:10,865] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:10,874] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka2:9095 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka2:9095 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:10,881] INFO [Controller id=1] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 1,3 (kafka.controller.KafkaController)
[2020-03-30 14:32:10,882] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,883] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,883] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,884] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:32:10,888] INFO [Controller id=1] Broker failure callback for 2 (kafka.controller.KafkaController)
[2020-03-30 14:32:10,889] INFO [Controller id=1] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-03-30 14:32:10,891] DEBUG [Controller id=1] Unregister BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-03-30 14:32:10,891] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 634, 3 -> 633) (kafka.controller.KafkaController)
[2020-03-30 14:32:10,976] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:11,069] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:11,072] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:11,072] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:11,074] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:32:11,075] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(1, 3) (kafka.controller.KafkaController)
[2020-03-30 14:32:11,079] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker kafka1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to kafka1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2020-03-30 14:32:11,081] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:11,083] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:11,085] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,086] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,087] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,087] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,091] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,092] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,093] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,112] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-03-30 14:32:11,144] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 11 and epoch zk version is now 11 (kafka.controller.KafkaController)
[2020-03-30 14:32:11,146] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2020-03-30 14:32:11,153] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-30 14:32:11,167] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-30 14:32:11,174] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2020-03-30 14:32:11,182] INFO [Controller id=3] Initialized broker epochs cache: Map(3 -> 633) (kafka.controller.KafkaController)
[2020-03-30 14:32:11,188] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2020-03-30 14:32:11,198] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2020-03-30 14:32:11,431] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,435] INFO [Controller id=3] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2020-03-30 14:32:11,437] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2020-03-30 14:32:11,439] INFO [Controller id=3] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-30 14:32:11,440] INFO [Controller id=3] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-30 14:32:11,441] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-30 14:32:11,448] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,450] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,452] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-30 14:32:11,457] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-03-30 14:32:11,459] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-30 14:32:11,484] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:11,489] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:11,511] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:11,516] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:11,518] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:11,523] INFO [RequestSendThread controllerId=3] Controller 3 connected to kafka3:9097 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-30 14:32:11,525] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:11,547] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:11,548] INFO [Controller id=3] Ready to serve as the new controller with epoch 11 (kafka.controller.KafkaController)
[2020-03-30 14:32:11,551] INFO [Controller id=3] Removing partitions Set() from the list of reassigned partitions in zookeeper (kafka.controller.KafkaController)
[2020-03-30 14:32:11,552] INFO [Controller id=3] No more partitions need to be reassigned. Deleting zk path /admin/reassign_partitions (kafka.controller.KafkaController)
[2020-03-30 14:32:11,559] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,560] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,561] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,563] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,564] INFO [Controller id=3] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2020-03-30 14:32:11,579] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-30 14:32:14,478] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2020-03-30 14:32:14,484] DEBUG [Controller id=3] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2020-03-30 14:32:14,487] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2020-03-30 14:32:14,504] TRACE [Controller id=3] All leaders =  (kafka.controller.KafkaController)
[2020-03-30 14:32:15,726] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:15,728] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:15,728] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-30 14:32:15,730] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2020-03-30 14:32:15,732] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2020-03-30 14:32:15,739] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-30 14:32:15,741] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-30 14:32:15,755] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2020-03-30 14:32:15,756] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2020-03-30 14:32:15,756] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-30 14:32:15,760] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
